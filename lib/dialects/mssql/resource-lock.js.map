{"version":3,"sources":["../../../../sequelize-es6/lib/dialects/mssql/resource-lock.js"],"names":["Promise","require","ResourceLock","resource","previous","resolve","prototype","unwrap","lock","r","disposer","module","exports"],"mappings":"AAAA;;AAEA,IAAMA,UAAUC,QAAQ,eAAR,CAAhB;;AAEA,SAASC,YAAT,CAAsBC,QAAtB,EAAgC;AAC9B,OAAKA,QAAL,GAAgBA,QAAhB;AACA,OAAKC,QAAL,GAAgBJ,QAAQK,OAAR,CAAgBF,QAAhB,CAAhB;AACD;;AAEDD,aAAaI,SAAb,CAAuBC,MAAvB,GAAgC,YAAW;AACzC,SAAO,KAAKJ,QAAZ;AACD,CAFD;;AAIAD,aAAaI,SAAb,CAAuBE,IAAvB,GAA8B,YAAW;AACvC,MAAMA,OAAO,KAAKJ,QAAlB;AACA,MAAIC,gBAAJ;;AAEA,OAAKD,QAAL,GAAgB,IAAIJ,OAAJ,CAAY,aAAK;AAC/BK,cAAUI,CAAV;AACD,GAFe,CAAhB;;AAIA,SAAOD,KAAKE,QAAL,CAAcL,OAAd,CAAP;AACD,CATD;;AAWAM,OAAOC,OAAP,GAAiBV,YAAjB","file":"resource-lock.js","sourcesContent":["'use strict';\n\nconst Promise = require('../../promise');\n\nfunction ResourceLock(resource) {\n  this.resource = resource;\n  this.previous = Promise.resolve(resource);\n}\n\nResourceLock.prototype.unwrap = function() {\n  return this.resource;\n};\n\nResourceLock.prototype.lock = function() {\n  const lock = this.previous;\n  let resolve;\n\n  this.previous = new Promise(r => {\n    resolve = r;\n  });\n\n  return lock.disposer(resolve);\n};\n\nmodule.exports = ResourceLock;\n"]}